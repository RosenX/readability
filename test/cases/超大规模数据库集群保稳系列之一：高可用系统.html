<html lang="en" dir="ltr" class=" theme-united"><head><meta charset="utf-8"><meta name="renderer" content="webkit"><meta http-equiv="x-ua-compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="author" content="soulteary@gmail.com"><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-LYVVHCWVNG&amp;l=dataLayer&amp;cx=c"></script><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-FSX5S86483&amp;l=dataLayer&amp;cx=c"></script><script src="https://hm.baidu.com/hm.js?7158c55a533ed0cf57dede022b1e6aed"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-158867676-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-158867676-1');</script><meta name="robots" content="index, follow"><meta property="og:title" content="超大规模数据库集群保稳系列之一：高可用系统"><meta property="og:description" content="基于过去多年在大规模数据集群保稳方面的实践经验，我们希望能够跟业界进行一些技术交流，美团技术团队举办了第75期技术沙龙。我们邀请到了美团研究员赵应钢担任出品人，同时请邀请到张洪、王占全、蔺瑞超、沈裕锋等4位数据库方向的4位技术专家，围绕进攻、防守、⾃愈、演练等几个方向展开分享。本文系超大规模数据库集群保稳系列的第一篇文章。"><meta property="og:type" content="article"><meta property="og:url" content="https://tech.meituan.com/2023/05/11/meituan-high-availability-system.html"><meta property="article:published_time" content="2023-05-11T00:00:00+00:00"><meta property="article:modified_time" content="2023-05-11T00:00:00+00:00"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="超大规模数据库集群保稳系列之一：高可用系统"><meta name="twitter:description" content="基于过去多年在大规模数据集群保稳方面的实践经验，我们希望能够跟业界进行一些技术交流，美团技术团队举办了第75期技术沙龙。我们邀请到了美团研究员赵应钢担任出品人，同时请邀请到张洪、王占全、蔺瑞超、沈裕锋等4位数据库方向的4位技术专家，围绕进攻、防守、⾃愈、演练等几个方向展开分享。本文系超大规模数据库集群保稳系列的第一篇文章。"><meta name="description" content="基于过去多年在大规模数据集群保稳方面的实践经验，我们希望能够跟业界进行一些技术交流，美团技术团队举办了第75期技术沙龙。我们邀请到了美团研究员赵应钢担任出品人，同时请邀请到张洪、王占全、蔺瑞超、沈裕锋等4位数据库方向的4位技术专家，围绕进攻、防守、⾃愈、演练等几个方向展开分享。本文系超大规模数据库集群保稳系列的第一篇文章。"><meta name="keywords" content="基础研发平台,运维,数据库,高可用,"><link rel="canonical" href="https://tech.meituan.com/2023/05/11/meituan-high-availability-system.html"><title>超大规模数据库集群保稳系列之一：高可用系统 - 美团技术团队</title><link rel="stylesheet" href="https://awps-assets.meituan.net/mit/blog/v20190629/common.css?v=Whistle&amp;t=20181017-1r"><link rel="stylesheet" href="https://awps-assets.meituan.net/mit/blog/v20190629/post.css?v=Whistle&amp;t=20181017-1r"><link rel="apple-touch-icon" sizes="180x180" href="https://awps-assets.meituan.net/mit/blog/v20190629/asset/icon/apple-icon-180x180.png?v=Whistle&amp;t=20181017-1r"><link rel="icon" type="image/png" sizes="192x192" href="https://awps-assets.meituan.net/mit/blog/v20190629/asset/icon/android-icon-192x192.png?v=Whistle&amp;t=20181017-1r"><link rel="shortcut icon" href="https://awps-assets.meituan.net/mit/blog/v20190629/asset/icon/favicon.ico?v=Whistle&amp;t=20181017-1r"><script>top!=self&&top.host!=self.host&&(top.location=self.location);(function(d){d.className=d.className.replace(/\bno-js/,'');})(document.documentElement);var $CONFIG={'data':{}};</script><link href="https://tech.meituan.com/feed/" rel="alternate" type="application/rss+xml" title="超大规模数据库集群保稳系列之一：高可用系统"><script src="https://awps-assets.meituan.net/mit/blog/v20190629/asset/vendor/zepto.min.js?v=Whistle&amp;t=20181017-1r"></script><script src="https://awps-assets.meituan.net/mit/blog/v20190629/common.js?v=Whistle&amp;t=20181017-1r"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head><body class="page page-type-post under-ios-device-mode"><div id="MathJax_Message" style="display: none;"></div><nav class="navbar navbar-default g-navbar-box hidden-print" id="Js_page-navbar"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
<span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>
<a class="navbar-brand" href="https://tech.meituan.com/" title="美团技术团队" target="_self">美团技术团队</a></div><div class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right" id="JS_nav_list"><li class="menu-item menu-item-home"><a class="menu-item-link" href="https://tech.meituan.com/" target="_self" title="查看最新文章">最新文章</a></li><li class="menu-item menu-item-archive"><a class="menu-item-link" href="/archives" target="_self" title="查看文章存档内容">文章存档</a></li><li class="menu-item menu-item-salon"><a class="menu-item-link" href="/tech-salon" target="_self" title="了解技术沙龙">技术沙龙</a></li><li class="menu-item menu-item-about"><a class="menu-item-link" href="/about" target="_self" title="了解更多关于我们的事情">关于我们</a></li></ul></div><div class="navbar-bottom"><p class="copyright">© 2023 美团技术团队</p><p class="copyright">All rights reserved.</p></div></nav><div class="container-fluid main-container" id="J_main-container"><div class="row"><div class="col-md-12"><div class="post-container"><h1 class="post-title"><a href="https://tech.meituan.com/2023/05/11/meituan-high-availability-system.html" rel="bookmark">超大规模数据库集群保稳系列之一：高可用系统</a></h1><div class="meta-box"><span class="m-post-date"><i class="fa fa-calendar-o"></i>2023年05月11日</span>
<span class="m-post-nick">作者: 张洪 李军 运洋 翊睿</span>
<span class="m-post-permalink"><i class="fa fa-link-o"></i><a href="https://tech.meituan.com/2023/05/11/meituan-high-availability-system.html" target="_blank">文章链接</a></span>
<span class="m-post-count"><i class="fa fa-pencil"></i>9786字</span>
<span class="m-post-reading"><i class="fa fa-hourglass-start"></i>20分钟阅读</span></div><div class="post-content"><div class="content"><p>本文整理自主题分享《美团数据库的高可用系统》，系超大规模数据库集群保稳系列的第一篇文章。对数据库而言，非常核心的就是如何保证其高可用性。本文围绕4个方面的内容展开，包括高可用简介、高可用部署、重点模块的设计思考以及对未来思考。希望能够对大家有所帮助或启发。</p><p>| <strong>B站视频</strong>：<a href="https://www.bilibili.com/video/BV1h84y1K7cA/?spm_id_from=333.999.0.0">美团数据库高可用系统<i class="fa fa-link" aria-hidden="true"></i></a></p><h2 id="00-出品人说">00 出品人说</h2><p>在数据库集群规模迅速扩大的背景下，如果出现故障，如何快速恢复成百甚至数千个集群的数据和服务，是很多大型互联网企业面临的重要挑战。线上部署了几十万的微服务，数据库结构和拓扑随时在发生变更，系统重构、内核升级、硬件设备汰换、机房搬迁等等，也都会对数据库的稳定工作产生一定的影响。作为整个IT系统中最为重要、最为底层的服务，即便遇到了极小概率事件的冲击，也会造成非常大的影响。对美团数据库团队来说，”低垂的果实已经摘完”，我们开始着力应对这些小概率事件对业务造成的冲击。</p><p>数据库稳定性保障的破局之道：一方面是提升平均无故障间隔（MTTF），另一方面是提升应急响应能力，即缩短平均修复时间（MTTR）。在这个两个目标的指引下，美团数据库团队从能力驱动和故障驱动两个维度来构造整个稳定性保障的闭环体系。</p><p>从能力驱动的角度，我们借鉴了Google的稳定性保障体系。在最底部的三层，通过故障演练/预案建设、复盘、可观测性的维度，思考怎么缩短故障处理时长；中间四层更多的是围绕研发需求、设计、上线、变更管控来降低故障的发生概率；顶层是产品运营，即通过面向内部用户的运营，指导业务对数据库进行选型和合理的使用，不断提升产品和平台易用性，并针对业务特点提供相应的解决方案。</p><p>从故障驱动的角度来说，包含事前预防和发现，事中故障定位，事后恢复、复盘和改进等等。从事前、事中、事后的全生命周期以及软件开发的各个阶段，全面提升管控和应急响应能力。</p><p><img src="https://p1.meituan.net/travelcube/2d23c4356a9c37a41a470c1ec51ecfa2357948.png" alt="图1 数据库稳定性保障的破局之道"><div class="img-figure"><span>图1 数据库稳定性保障的破局之道</span></div></p><p>基于过去多年保稳定方面的实践，本次沙龙将从如何提升进攻和防守能力，如何提升快速恢复能力，以及在进攻、防守、恢复形成闭环后，如何让人、系统、流程更好的协同和应对大规模故障几个方面，围绕数据库的高可用系统、数据库攻防演练建设实践、数据库容灾体系建设、数据库自治服务平台建设等4个议题进行介绍。希望能给从广大数据库从业者、业务研发人员带来启发和帮助。</p><h2 id="01-高可用简介">01 高可用简介</h2><h3 id="1-1-面临的挑战">1.1 面临的挑战</h3><p>首先分享下美团数据库高可用面临的问题和挑战，主要从3个层面进行展开：</p><p>第一个挑战是实例增长越来越快。下图1截取了2019年1月到2022年1月的数据，可以明显地看到实例规模的增长非常迅速，在大规模场景下，如何保证每一个实例的高可用性是一个非常大的挑战。大家都知道，保障几台机器稳定运行，跟保障几万台甚至几十万台机器的稳定运行，其复杂度完全不在一个量级。</p><p><img src="https://p0.meituan.net/travelcube/49f722c4bec5062c1c8bba4fb2ea081650605.png" alt="图2 实例增长曲线"><div class="img-figure"><span>图2 实例增长曲线</span></div></p><p>第二个挑战是可用性（RTO）要求越来越严。美团业务类型偏在线实时交易，对系统可用性有非常高的要求，特别是即时配送要求更高。在业务发展的早期阶段，体量并发也不高，对系统可用性要求可能只有99.9%。但是随着业务体量快速增长，对系统可用性的要求就会不断增加，特别是比较偏底层的数据库系统，从99.9%到99.99%甚至更高。</p><p><img src="https://p0.meituan.net/travelcube/992d2396285915f8d9fa03f3d469fd72223949.png" alt="图3 系统可用性对应的宕机时间"><div class="img-figure"><span>图3 系统可用性对应的宕机时间</span></div></p><p>第三个挑战是容灾场景的复杂性。容灾场景主要分成三个层面，第一个是常规容灾，比如日常软件、硬件或者网络故障；第二个是AZ容灾，即机房层面，如机房断网、机房宕机等；第三个是Region容灾，即更大空间容灾，典型的是城市级容灾，目前主要还在解决AZ级容灾，分如下五个阶段：</p><p><img src="https://p0.meituan.net/travelcube/fe898730ac638a59a5987a757587ee791042332.png" alt="图4 AZ容灾能力等级"><div class="img-figure"><span>图4 AZ容灾能力等级</span></div></p><p>从图4可以看到，我们将AZ容灾分设第0至第4共5个阶段，简称L0-L4。随着等级的提高，场景越来越复杂，相应的规模也越大。从容灾规模维度看，单点-&gt;单个集群-&gt;某个业务依赖的集群-&gt;AZ内的集群，不同规模要求的能力是完全不一样的，除了规模之外还有容灾的场景也会在变化。</p><ul><li>“L0-L1”这两个等级侧重面向常规容灾，是实例级容灾。</li><li>“L2-L3”这两个等级侧重面向AZ容灾，相比L1有非常大的跨越，因为既要解决“L0-L1”面临的常规容灾问题，还要解决一个很核心的问题，即整高可用自身是否能够快速恢复，以及高可用依赖的下游服务是否具备容灾切换能力。由于高可用本身是一个系统，它有数据面和控制面，有上下游依赖，所以先保证自己是可用的，才能保证数据库的RTO和RPO。</li><li>L4，从L3到L4又有一个很大的跨越，因为L3是的规模是相对可控的，而L4直接是断AZ的网络，AZ的大小不同，它涉及更大场景是更真实的AZ容灾。</li></ul><h3 id="1-2-发展历程">1.2 发展历程</h3><p>接下来，分享一下美团高可用系统发展历程。总的来说，美团的高可用发展历程是根据不同的阶段的矛盾和挑战，做出的相应解决策略和方案。到目前为止，有三次比较大的系统架构迭代：</p><ul><li>第一代架构是2015年之前，称为MMM（Multi-Master Replication Manager for MySQL），该架构包括接入层VIP、Agent和Manager，这架构本身存在很多问题，比如VIP接入无法支持跨机房、跨网段；Agent和实例绑死，本身也没有高可用，维护起来比较困难；Manager还是单点。</li><li>第二代架构是2015-2019年，称为MMHA（Meituan Master High Availability），是在MHA的基础上结合美团数据库生态定制的架构，解决了第一代架构中VIP接入和Agent误判的一些问题，但在2019年以后，由于实例规模变得很大且增长迅速，该架构管理起来异常复杂，Manager是单点且本身没有高可用。同时，2019年整个PAAS在演练机房故障，所以当时这个架构逐渐暴露出各种稳定性问题。</li><li>第三代架构是2019年，新开了基于Orchestrator定制的高可用系统，实际开始时间是2018年，2019年开始灰度。当时MGR在业界已经有些公司在使用，MGR通过分布式协议来解决高可用难题，我们对此进行了深入的思考：我们是否能引入一个类似分布式协议解决高可用系统面临的问题，本质上就是把MGR中内置的分布式协议放到高可用系统实现。</li></ul><p>后来根据这个想法落地的架构就是当前的高可用系统，是一个Raft Group，多节点、多机房部署。以前主要关注主从切换，但新系统类似八爪鱼，所有在集群里的节点都是统一托管，如主库、从库、Ripple（后续有说明）等；另一方面，它是一个高可用、高性能、大规模并发处理架构，我们部署了多个Raft Group分组来托管不同地域和服务等级数据库集群。除此之外，我们也正在思考新一代去中心化的新架构，将在文章的最后一个章节进行介绍。</p><p><img src="https://p1.meituan.net/travelcube/266304e3143d2fa5a31dda301dd423fa507146.png" alt="图5 美团高可用架构的发展历程"><div class="img-figure"><span>图5 美团高可用架构的发展历程</span></div></p><h2 id="02-高可用部署">02 高可用部署</h2><h3 id="2-1-高可用架构-数据流-控制流">2.1 高可用架构（数据流、控制流）</h3><p>这部分主要分两条线：控制流和数据流。</p><ul><li>数据流：如果业务应用要访问数据库，它是如何拿到数据的，一个SQL过来是如何把数据返回回去的，业务应用通过访问中间件看到MySQL的拓扑，数据流比较简单，也是业界比较通用的做法。</li><li>控制流：业务应用要通过访问中间件来访问到正常数据库拓扑，需要用高可用组件来解决故障转移难题。</li></ul><p>由下图6可看出，高可用组件分四个部分：HA Core是经典的3节点Raft Group部署（也可以是多节点部署）；HA平台是管控系统，如主动切换、状态机查看、兜底等；HAservice是HA的API服务，负责跟外围系统交付；调度系统包括（Scheduler、Worker），是一个流程调度服务，处理状态机的轮转。元数据存储是外围依赖的核心服务，负责基础配置的管理，当配置变更后会通过它下发到所有的中间件节点，保证业务看到的是正常的数据库拓扑。</p><p><img src="https://p0.meituan.net/travelcube/a177324e44daadb034579f65e525a9cf372015.png" alt="图6 高可用架构图"><div class="img-figure"><span>图6 高可用架构图</span></div></p><h3 id="2-2-高可用部署-ha-core-微服务-数据层">2.2 高可用部署（HA Core、微服务、数据层）</h3><p>下面我们围绕4个高可用组件来展开介绍一下，高可用部署在应对AZ级容灾或Region级容灾的策略。</p><p><img src="https://p1.meituan.net/travelcube/aebffbcb41eed9e9fccd59f8e675c40c701675.png" alt="图7 高可用部署架构"><div class="img-figure"><span>图7 高可用部署架构</span></div></p><p>一是<strong>HA Core部署</strong>，它有三个特征：一是多Region，如下图6所示，以红色线为分界，左边是Region 1，右边是Region 2；二是多AZ，每一个HA Core是3AZ部署；三是多集群，每个HA Core的3节点集群会托管MySQL千级别实例。</p><p>二是<strong>微服务</strong>，有同步服务、调度服务和配置中心。</p><ul><li>同步服务：简单来说，我们的工程师在RDS申请集群或DB之后的信息会全部同步注册到HA Core服务里面去，相当于HA Core是一个“八爪鱼”，它能发现这些信息。</li><li>任务调度：它也包括API Service、Scheduler和Worker，主要做状态机任务执行。这两个服务都是多Region、多机房部署，它们本身没有状态。</li><li>配置中心：业务应用访问中间件和高可用之间的数据同步纽带，是MySQL的节点发现和处理的核心组件，是双Region部署，有自己的组件，比如有API、Config和Consistency。</li></ul><p>三是<strong>数据层</strong>，微服务除了配置中心，其他服务没有状态，因为状态都在数据层，数据层服务都是MGR集群，而且这些集群各自作用不一样，MGR是单Region写、多Region读，所以这里我们回到最开始说的Region容灾，这些数据需要做单元化或者隔离，现在这些集群还是单Region写的。</p><p>四是<strong>管控层</strong>，它是正常的平台服务，常规化的部署。</p><h2 id="03-重点模块设计">03 重点模块设计</h2><h3 id="3-1-故障发现-减少漏判-降低误判">3.1 故障发现（减少漏判、降低误判）</h3><p>故障发现有两个核心指标：</p><ul><li>第一个指标是不要漏判，如果故障没有判断，那RTO其实根本就不生效。</li><li>第二个指标是降低误判，因为我们知道RTO不可能等于0，即RTO一定对业务有影响，如果一天误判几次，那对业务是无法接受的，对业务是有损的。</li></ul><p>先说漏判，如下图8所示的故障探测通道，每个探测通道完全独立，如普通探测通道，心跳探测通道、从库探测等完全独立决策，谁先发现都可以作为决策依据，现阶段这些通道都是在服务端主动并发发起探测。另外一方面就是业务端，访问中间件有业务端的报错，也纳入故障探测和决策，这个是业务视角的故障，不管什么问题只要业务达到有损阈值就可以判断决策，这部分还在建设中。综合多通道、以及客户端和服务端判定，哪一个通道发现了问题，直接开始做决策，不受其他通道影响，这是解决漏判问题的策略。</p><p><img src="https://p0.meituan.net/travelcube/28956ae632d731fb193e88562a389f71757787.png" alt="图8 故障发现"><div class="img-figure"><span>图8 故障发现</span></div></p><p>再说减少误判，我们引入了多节点协商机制，比如我们遇到某些问题会引入“民主”决策让大家发挥更多意见，最终汇总得出结论。HA Core是多节点，当每个节点独立探测，探测后也会独立去做判断和分析，如只有一个Follower节点认为故障是没用的，还需要Leader的分析并向其他Follower节点发起协商共同决策，只有大多数节点认为故障才会把它确定为故障，会注册故障并进行故障处理流程。图中的Backend DB是Raft Group每个节点各自独立的存储，各自探测的拓扑以及判定决策信息等都存在本地。</p><h3 id="3-2-故障选举-选举因子-选举策略">3.2 故障选举（选举因子、选举策略）</h3><p>所谓故障选举一定是多个从库，一主一从不存在选举。美团的MySQL集群现状是1主多从，所以选举异常复杂，因为我们要保证容灾N+1、多AZ甚至多Region部署，选举时选谁做主库就非常重要，主要有两个影响因素：选举因子和选举策略。选举因子+选举策略 = 决定谁是新主。</p><p>（1）选举因子是影响选举的核心要素，一次故障有20多个选举因子会共同影响如何排序。</p><p><img src="https://p0.meituan.net/travelcube/e1950801f284647d8c61c6b0b6db78bd270454.png" alt="图9 选举因子"><div class="img-figure"><span>图9 选举因子</span></div></p><p>举两个例子，第一个是版本，一主五从的集群可能有三个版本，如果让最新的版本作为新主就会有问题，要尽量不让它作新主，因为如果新主的版本是最新的，但从库都是比他落后的低版本，就会出现一些兼容性问题；第二个是权重，假设其他因子都一样，但存在运维和例行维护的情况下会人为说把权重降低，或标记一个实例不能作为新主，那么权重100的比权重50的有更大机会成为新主。每个选举因子都有权重，最终做综合排序，如版本、binlog格式、权重、服务器配置等，综合选举因子的选举结果是1M（first master）。</p><p>但1M并不一定是最优，有业务是北上跨Region部署，如之前主库在北京，按照选举因子排序选出的1M到上海去了，显然是业务无法接受的，因为老主库在北京说明绝大部分业务部署在北京，一旦让它跨Region写入到上海，那么RT会增加很多，所以引入了选举策略。</p><p>（2）选举策略是同机房优先&gt;同中心优先&gt;同区域优先，是一个灵活的fallback策略。按照选举策略重新选举一个新主（称为2M），如果2M和1M是重叠的，就认为这个1M是满足业务诉求的Master，会将1M作为最终的主库。但有时候1M和2M的排序相差很大，这时我们尽量让那种没办法改变的因素以它为基础，把其它能改变的因素对齐，比如地域很难改变，但是要改位点等容易改变，最终权衡后选举出新主库。</p><p><img src="https://p0.meituan.net/travelcube/18d9b0a8c376f6747c7d54c2d0bb463a305243.png" alt="图10 选举策略"><div class="img-figure"><span>图10 选举策略</span></div></p><p><strong>举例</strong>：</p><ul><li>如图11（主库M，从库S1、S2、S3、S4四个实例），S2的选举规则(promotion rule)是一票否决的Must Not，那它一定不能做主库，即使选不出来其他，它也做不了主库。</li><li>S1和老主库是同AZ的即都是AZ1，S1比AZ2的S3和S4有更高优先级，即更大的机会作为新主。</li><li>S4权重100，S3权重90，S4比S3权重更高，即使S4是独享容器，它也有更高的选举权。</li></ul><p><img src="https://p0.meituan.net/travelcube/26840752a97a01442aac7e3d3fc3a6ba196409.png" alt="图11 选举示例"><div class="img-figure"><span>图11 选举示例</span></div></p><p>这个例子说明最终选举出的主库是综合考虑后的排序，受各种因子影响。</p><h3 id="3-3-数据一致性-四个风险及解决方案">3.3 数据一致性（四个风险及解决方案）</h3><p>为什么要保证数据一致？在我们现在这种规模的业务场景下，可用性优先策略已经没办法覆盖所有的业务场景，但是在主从架构下面，数据丢失又无处不在，参考图12为例，数据丢失的风险点比较多：</p><ul><li>问题1，可能binlog未实时落盘。</li><li>问题2，IO线程没拿到最新数据。</li><li>问题3，SQL线程没有和IO线程对齐，包括从库之间binlog位点也不一样。</li><li>问题4，从库不完整事务问题，在主库事务提交时它是完整的，但是它通过IO线程同步给从库时不是按事务粒度去同步而是按事件event粒度同步，如果事务未完整接收也可能会产生数据丢失不一致。</li></ul><p><img src="https://p0.meituan.net/travelcube/975c723dc4b7ba7563e461aabd141176380763.png" alt="图12 四个风险"><div class="img-figure"><span>图12 四个风险</span></div></p><ul><li>针对问题3和问题4，其实归纳一下就是说只要有从库拿到数据，不管是否对齐，我们是有策略能够保证一致性，这个策略叫S1，只要数据同步过去了则就可以通过S1保证一致性。</li><li>针对问题2，就是主库Event，没有任何一个从库有获取全，这种情况必须解析老主库binlog以及计算binlog位点并获取到数据，并在切换中补齐数据，即在开放给业务写流量之前，会将数据给新主库补全保证一致性，这个策略叫S2。</li><li>但S1+S2也不能保证0RPO，服务器宕机时拿不到老主库binlog，没有办法计算、解析和处理，不能保证0RPO，大概有20%到30%的比例。</li></ul><p>接下来，讲一下针对老主库宕机拿不到数据时的解决方案（这个叫策略S3）。在此，也参考MySQL主从库架构通过IO线程和SQL线程去解决一致性的思路。第一个难点，IO线程要尽量把数据拿全，这是非常关键的点，也是很难的事情；第二个难点，SQL线程能够快速把数据应用下去，达到这两方面才能保证0RPO。</p><p>第一个难点解决方案如图13所示，核心是Ripple，它是一个高性能的binlog订阅服务器，作用类似IO线程，保证快速的获取binlog。第一个特性是它的性能极高，因为普通从库IO线程除了处理binlog接收请求外，也处理很多比如写Relay log、一些锁逻辑处理，以及配合SQL线程一致性的工作，而Ripple的任务就是快速将数据全部拿过来而不用处理其它逻辑，binlog同步速度是普通MySQL IO线程的3倍以上；第二个特性是可以配置强一致，支持半同步机制，如果你认为可以牺牲RTO，比如可以牺牲3分钟但不能丢失数据，那么配置多副本的半同步超时策略（如3分钟），由于Ripple的性能高，实际超时时间远远小于这个值，退化概率非常低；第三个特性，它本身是一个存算分离的架构，即Ripple是轻量级容器+EBS云盘，用这样一种架构来保证数据完全。</p><p><img src="https://p0.meituan.net/travelcube/33719c657337e5c6c11dd86269c3480f792349.png" alt="图13 基于Ripple的一致性方案"><div class="img-figure"><span>图13 基于Ripple的一致性方案</span></div></p><p>第二个难点是事中从Ripple补数据，Ripple毕竟不是普通的MySQL，所以需要HA去兼容，但HA处理数据比SQL线程灵活很多，因为SQL线程在需要实时处理数据来保证一致性，而HA只有在故障期间才处理数据，可以拉长RTO做很多定制。还有这里提到的RPO≈0，为什么是近似，因为虽然可以做到RPO=0，但要接受RTO的损耗。如果你既要RTO，又要RPO，那么可以在策略灵活配置。</p><p>在目前业务规模下没办法兼得RTO和RPO，如果想要RTO就要牺牲一部分RPO或者反过来。本身里面有一些不可控因素会影响核心指标，比如事务的大小、延迟、完整性等，我们将这些配置通过策略开放给业务，让业务自己去决策。举个例子，如果你的业务有很多大事务，但你又要想0RPO，那么你就需要配置更长的RTO损耗。</p><ul><li>可用性优先：可根据业务特性自定义，承诺RTO不保证RPO。</li><li>一致性优先：可根据业务特性自定义，保证RPO但不会无限制，RTO会控制上限。</li><li>不可控因素：事务大小、延迟、事务完整性等。</li></ul><p><img src="https://p0.meituan.net/travelcube/a0be38c2a39f6b178a8a0914a9b42e1f232474.png" alt="图14 可用性优先/一致性优先"><div class="img-figure"><span>图14 可用性优先/一致性优先</span></div></p><h3 id="3-4-多机房高可用">3.4 多机房高可用</h3><p>常规场景，Leader故障后会在4秒之内快速选举一个新Leader出来继续工作，但也有一些场景，如下图14所示，MySQL Master和HA 的Leader都在AZ1，如果AZ1宕机之后怎么办？其实就出现右边这个图。老Leader在处理AZ1里的MySQL节点故障的同时，由于自身Leader也在AZ1，会中断老Leader的处理状态机并选举一个Leader，但新Leader并不知道老Leader状态机如何处理，就直接导致切换的失败。</p><p><img src="https://p0.meituan.net/travelcube/828625deb445f1878383de8c8d055ab1220882.png" alt="图15 多机房高可用"><div class="img-figure"><span>图15 多机房高可用</span></div></p><p>多机房高可用的的核心解决思路是保证各个节点之间状态机的连续性。所谓状态机的连续性，就是Leader实时把状态机同步到所有Follower节点，一旦Follower节点重新变为Leader点后，它会继续老Leader的状态机，会有动作的临界状态判断。如下图15所示，它根据执行的代价判断是回滚还是继续执行，如果回滚，就会把老Leader状态机全部回滚之后从零开始处理；另外一方面，如果由于集群的拓扑和状态被破坏了，导致回滚状态机比较麻烦或回滚不了，那么就会继续执行老Leader状态机没有执行完的动作。</p><p>保证多节点状态机连续性：</p><p><img src="https://p1.meituan.net/travelcube/f9495449a435b73cf6e6837cfe36c606119932.png" alt="图16 保证各个节点之间状态机的连续性"><div class="img-figure"><span>图16 保证各个节点之间状态机的连续性</span></div></p><ul><li>状态同步：Leader实时将状态机通过Raft同步到所有的Follower节点</li><li>临界状态：根据执行代价确定的状态机临界点</li><li>回滚：新Leader执行状态机回滚，包括对应的操作</li><li>继续：新Leader继续执行老Leader的状态机</li></ul><h3 id="3-5-配置下发-双region下发">3.5 配置下发（双Region下发）</h3><p>由于配置服务是双Region部署，分为同Region下发和跨Region下发。同Region下发会写到存储层，而config-server会更新最新配置，并将配置并推送到客户端。跨Region下发，比如说北京、上海和深圳都有业务服务节点，最终把它推送下去的时候也会走一致性服务（Consistency-Server），即一旦某个Region更新后，我们会把数据推送到另一个Region里，Region之间的数据完全一致，如果另外一个的Region有业务服务节点，就会继续走同Region下发流程。</p><p><img src="https://p0.meituan.net/travelcube/bbb5e7c6c0c4c224c0e2f1719d831194300337.png" alt="图17 双Region下发"><div class="img-figure"><span>图17 双Region下发</span></div></p><h2 id="04-未来思考">04 未来思考</h2><p>最后，分享一下对高可用未来的一些思考，主要包括以下三个方面：</p><ul><li>提升容灾能力，主要是AZ级容灾和Region级容灾。这两方面我们还在建设中，AZ级容灾需要减少依赖，不能减少的需要AZ级闭环独立部署，以及提升大规模并发处理的能力等；Region级容灾方面，我们在做一些单元化的思考和方案，尽量让包括数据层等所有服务闭环，不要跨区域访问。</li><li>去中心化架构。业界也有数据库把高可用内置到MySQL，如MGR，内置到MySQL有非常多的有优势，但对于美团一主多从架构是现状前提。另外，MGR架构对网络抖动的容忍度较低，以及对请求延时有一些增加，导致大部分业务场景没法接受。所以，我们在做另外一种思路，即把高可用内置到Proxy进程，让Proxy自带数据库高可用的能力，跟内置到MySQL的思路类似。</li><li>去依赖化、集群化。将HA的Service、Scheduler和Worker及配置中心等下游依赖去掉，希望内置到Proxy进程后，内部数据通过Raft/Gossip协议同步而不再依赖中心化服务，让它完全做集群化，这也是我们2023年在思考的策略。</li></ul></div></div><div class="meta-box post-bottom-meta-box hidden-print"><span class="tag-links"><i class="fa fa-tags" aria-hidden="true"></i><a href="/tags/%E5%9F%BA%E7%A1%80%E7%A0%94%E5%8F%91%E5%B9%B3%E5%8F%B0.html" rel="tag">基础研发平台</a>, <a href="/tags/%E8%BF%90%E7%BB%B4.html" rel="tag">运维</a>, <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93.html" rel="tag">数据库</a>, <a href="/tags/%E9%AB%98%E5%8F%AF%E7%94%A8.html" rel="tag">高可用</a></span></div><div class="row page-navigation-container hidden-print"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><div class="navigation-wrapper"><div class="pager"><div class="title-box"><i class="fa fa-paperclip"></i>#看看其他</div><a href="https://tech.meituan.com/2023/04/20/traceid-google-dapper-mtrace.html" title="一次「找回」TraceId的问题分析与过程思考" class="previous"><span aria-hidden="true">前一篇: 一次「找回」TraceId的问题分析与过程思考</span></a>
<a href="https://tech.meituan.com/2023/05/18/robust-2.0-android-r8.html" title="Robust 2.0：支持Android R8的升级版热修复框架" class="next"><span aria-hidden="true">后一篇: Robust 2.0：支持Android R8的升级版热修复框架</span></a></div></div></div></div><div class="row page-comments-container hidden-print"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><div class="comments-wrapper hidden-print"><div id="comments" class="comments-disabled"><div class="title-box"><i class="fa fa-comments-o"></i>#一起聊聊</div><div class="post-feedback-box hidden-print"><p>如发现文章有错误、对内容有疑问，都可以关注美团技术团队微信公众号（meituantech），在后台给我们留言。</p><img class="qrcode" src="https://p1.meituan.net/travelcube/b0364d579285ab22aa6235bd100d7c22178175.png" alt="美团技术团队微信二维码"><p class="follow-us">分享一线技术实践，沉淀成长学习经验</p></div></div></div></div></div><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>MathJax.Hub.Config({tex2jax:{inlineMath:[['$','$'],['\\(','\\)']],processEscapes:true}});</script></div></div></div></div><div class="container-fluid main-container" id="J_footer-container"><script>$CONFIG['data']['footerLink']=[{"name":"网站首页","link":"/"},{"name":"文章存档","link":"/archives"},{"name":"关于我们","link":"/about"}];</script><div class="row"><div class="col-md-12 footer-links-container"><div class="footer-divider"></div></div><div class="col-md-4"><p>一行代码，亿万生活。</p></div><div class="col-md-8"><ul class="nav nav-pills navbar-right"><li class="menu-item"><a href="/" title="">网站首页</a></li><li class="menu-item"><a href="/archives" title="">文章存档</a></li><li class="menu-item"><a href="/about" title="">关于我们</a></li></ul></div></div><div class="m-fixed-button"><div class="m-wrapper"><div class="m-qrcode"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAAsSAAALEgHS3X78AAAAjklEQVRIx81V2xHAIAjTnruyhmuwbb96Z6kYOJWaTx6SKGBm5poMIKJXnDXvsgTNoGgMrUxR3nYFnwLMXHusNTvyx73BA+1ONTvyb1eQvXNgjQ9T4EbbLaizQhQsKTBSsVyBvLbi7YoWaDZS6gzaDPNeUfM2lXOgHSjz4ncRYub92c7Zpgjnb1ON8e9vcAOBkF++GF/4vQAAAABJRU5ErkJggg=="></div><div class="m-go-top"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAAsSAAALEgHS3X78AAAB/ElEQVR42u3bX0rcUBiG8cc/o+5CwW5CL0rpJirY+2zDbZzbti6klXYhCm7B0Ssv7AfqJAMz7zk5n/A+VzMhTL78IOSQITullCvc1u32HuCjZ0AxA4oZUMyAYgYUM6CYAcUMKGZAMQOKGVDMgGIGFDOgmAHFDChmQDEDihlQzIBiBhQzoJgBxQwoZkAxA4rt9x5gTQ/Ab2AP+Awc9h5orKyAD8DPYRjuAUopt8AlcNR7sPdlvITf4AEMw3AHXAPL3sO9LxvgCl6UFTET4ApeKeVTKeUkvmdEzAI4igdcAJeZETMALpnG2wcWJEbsDbgEfozgfePtCiEtYk/AdXiLkf1TIvYC3BQvWof42ONEegBuixdNIf6iA+LcgCpelAZxTsAxvFM2x4tSIM4FOIV3wXZ4USAex4a5EecAbIUXLYDvvRBbA7bGi7ohtgScCy/qgtgKcG68aAqx2TqxBWAvvGgM8ZZGiLUBe+NFY3fnJog1AbPgRQdMIz7VOkhNwD+J8KIpxJtaB2hyE0mCF60g1myn4iv/j8BfXp7jnZED73VPwL//n895gZWr+bfmIfB1ZpRNOgC+1P7R3k+kP3wGFDOgmAHFDChmQDEDihlQzIBiBhQzoJgBxQwoZkAxA4oZUMyAYgYUM6CYAcUMKGZAMQOKGVDMgGIGFDOg2DOEU/uBJ0Ro/gAAAABJRU5ErkJggg=="></div></div><div class="qrcode-container"><div class="qr_code"><p class="desktop_qr_tittle">扫码关注技术博客</p><img src="https://p1.meituan.net/travelcube/7d0f734bcd029f452d415ce7d521a0d9632811.gif" class="qr_img"></div></div></div></div><script src="https://awps-assets.meituan.net/mit/blog/v20190629/post.js?v=Whistle&amp;t=20181017-1r"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-55279261-1"></script><script>try{window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-55279261-1');}catch(e){}</script><script>try{var _hmt=_hmt||[];var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?7158c55a533ed0cf57dede022b1e6aed";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);}catch(e){}</script></body></html>